# ⌛ 分库分表相关概念

---

首先要明确一点：分库分表是两回事儿，可能是光分库不分表，也可能是光分表不分库，也可能都分。

## 1. 为什么要分库分表

**分库分表是为了解决由于库、表数据量过大，而导致数据库性能持续下降的问题。**

## 2. 垂直拆分 和 水平拆分

- **垂直拆分**的意思，就是**把一个有很多字段的表给拆分成多个表（或者是多个库）上去。每个库表的结构都不一样，每个库表都包含部分字段**。

  <img src="https://gitee.com/veal98/images/raw/master/img/20201126134834.png" style="zoom:67%;" />

  一般来说，会将较少的访问频率很高的字段放到一个表里去，然后将较多的访问频率很低的字段放到另外一个表里去。因为数据库是有缓存的，你访问频率高的行字段越少，就可以在缓存里缓存更多的行，性能就越好。

- **水平拆分**的意思，就是**把一个表的数据分到多个表（或者是多个库）里去**，但是**每个库的表结构都一样**，只不过每个库表放的数据是不同的，所有库表的数据加起来就是全部数据。水平拆分的意义，就是将数据均匀放更多的库里，然后用多个库来扛更高的并发，还有就是用多个库的存储容量来进行扩容。

  <img src="https://gitee.com/veal98/images/raw/master/img/20201126134847.png" style="zoom:67%;" />

## 3. 分库 和 分表

- **单表数据量太大，会极大影响你的 sql 执行的性能**，到了后面你的 sql 可能就跑的很慢了。

  **分表**就是把一个表的数据放到多个表中，使得每张表的数据量在可控的范围内。

- **分库**就是将一个库的数据拆分到多个库中

|              |          分库分表前          |                  分库分表后                  |
| :----------: | :--------------------------: | :------------------------------------------: |
| 并发支撑情况 | MySQL 单机部署，扛不住高并发 |  MySQL 从单机到多机，能承受的并发增加了多倍  |
| 磁盘使用情况 |  MySQL 单机磁盘容量几乎撑满  | 拆分为多个库，数据库服务器磁盘使用率大大降低 |
| SQL 执行性能 | 单表数据量太大，SQL 越跑越慢 |     单表数据量减少，SQL 执行效率明显提升     |

## 📚 References

- [Advanced Java - 为什么要分库分表？](https://doocs.gitee.io/advanced-java/#/./docs/high-concurrency/database-shard)